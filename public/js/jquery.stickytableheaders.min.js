(function(e,t,n){"use strict";function o(n,o){var u=this;u.$el=e(n);u.el=n;u.id=i++;u.$window=e(t);u.$document=e(document);u.$el.bind("destroyed",e.proxy(u.teardown,u));u.$clonedHeader=null;u.$originalHeader=null;u.isSticky=false;u.hasBeenSticky=false;u.leftOffset=null;u.topOffset=null;u.firstTime=true;u.init=function(){u.$el.each(function(){var t=e(this);t.css("padding",0);u.$originalHeader=e("thead:first",this);u.$clonedHeader=u.$originalHeader.clone();t.trigger("clonedHeader."+r,[u.$clonedHeader]);u.$clonedHeader.addClass("tableFloatingHeader");u.$clonedHeader.css("display","none");u.$originalHeader.addClass("tableFloatingHeaderOriginal");u.$originalHeader.after(u.$clonedHeader);u.$printStyle=e('<style type="text/css" media="print">'+".tableFloatingHeader{display:none !important;}"+".tableFloatingHeaderOriginal{position:static !important;}"+"</style>");e("head").append(u.$printStyle)});u.setOptions(o);u.updateWidth();u.toggleHeaders();u.bind()};u.destroy=function(){u.$el.unbind("destroyed",u.teardown);u.teardown()};u.teardown=function(){if(u.isSticky){u.$originalHeader.css("position","static")}e.removeData(u.el,"plugin_"+r);u.unbind();u.$clonedHeader.remove();u.$originalHeader.removeClass("tableFloatingHeaderOriginal");u.$originalHeader.css("visibility","visible");u.$printStyle.remove();u.el=null;u.$el=null};u.bind=function(){u.$scrollableArea.on("scroll."+r,u.toggleHeaders);if(!u.isWindowScrolling){u.$window.on("scroll."+r+u.id,u.setPositionValues);u.$window.on("resize."+r+u.id,u.toggleHeaders)}u.$scrollableArea.on("resize."+r,u.toggleHeaders);u.$scrollableArea.on("resize."+r,u.updateWidth)};u.unbind=function(){u.$scrollableArea.off("."+r,u.toggleHeaders);if(!u.isWindowScrolling){u.$window.off("."+r+u.id,u.setPositionValues);u.$window.off("."+r+u.id,u.toggleHeaders)}u.$scrollableArea.off("."+r,u.updateWidth)};u.toggleHeaders=function(){if(u.$el){u.$el.each(function(){var t=e(this),n,r=u.isWindowScrolling?isNaN(u.options.fixedOffset)?u.options.fixedOffset.outerHeight():u.options.fixedOffset:u.$scrollableArea.offset().top+(!isNaN(u.options.fixedOffset)?u.options.fixedOffset:0),i=t.offset(),s=u.$scrollableArea.scrollTop()+r,o=u.$scrollableArea.scrollLeft(),a=u.isWindowScrolling?s>i.top:r>i.top,f=(u.isWindowScrolling?s:0)<i.top+t.height()-u.$clonedHeader.height()-(u.isWindowScrolling?0:r);if(a&&f||u.firstTime){n=i.left-o+u.options.leftOffset;u.$originalHeader.css({position:"fixed","margin-top":0,left:n,"z-index":3});u.leftOffset=n;u.topOffset=r;u.$clonedHeader.css("display","");if(!u.isSticky){u.isSticky=true;u.updateWidth()}u.setPositionValues();if(u.firstTime){u.$originalHeader.css("position","static");u.$clonedHeader.css("display","none");u.isSticky=false;u.firstTime=false}}else if(u.isSticky){u.$originalHeader.css("position","static");u.$clonedHeader.css("display","none");u.isSticky=false}})}};u.setPositionValues=function(){var e=u.$window.scrollTop(),t=u.$window.scrollLeft();if(!u.isSticky||e<0||e+u.$window.height()>u.$document.height()||t<0||t+u.$window.width()>u.$document.width()){return}u.$originalHeader.css({top:u.topOffset-(u.isWindowScrolling?0:e),left:u.leftOffset-(u.isWindowScrolling?0:t)})};u.updateWidth=function(){if(!u.isSticky){return}if(!u.$originalHeaderCells){u.$originalHeaderCells=e("th,td",u.$originalHeader)}if(!u.$clonedHeaderCells){u.$clonedHeaderCells=e("th,td",u.$clonedHeader)}var t=u.getWidth(u.$clonedHeaderCells);u.setWidth(t,u.$clonedHeaderCells,u.$originalHeaderCells);u.$originalHeader.css("width",u.$clonedHeader.width())};u.getWidth=function(n){var r=[];n.each(function(n){var i,s=e(this);if(s.css("box-sizing")==="border-box"){i=s.outerWidth()}else{var o=e("th",u.$originalHeader);if(o.css("border-collapse")==="collapse"){if(t.getComputedStyle){i=parseFloat(t.getComputedStyle(this,null).width)}else{var a=parseFloat(s.css("padding-left"));var f=parseFloat(s.css("padding-right"));var l=parseFloat(s.css("border-width"));i=s.outerWidth()-a-f-l}}else{i=s.width()}}r[n]=i});return r};u.setWidth=function(e,t,n){t.each(function(t){var r=e[t];n.eq(t).css({"min-width":r,"max-width":r})})};u.setOptions=function(n){u.options=e.extend({},s,n);u.$scrollableArea=e(u.options.scrollableArea);u.isWindowScrolling=u.$scrollableArea[0]===t};u.updateOptions=function(e){u.setOptions(e);u.unbind();u.bind();u.updateWidth();u.toggleHeaders()};u.init()}var r="stickyTableHeaders",i=0,s={fixedOffset:0,leftOffset:0,scrollableArea:t};e.fn[r]=function(t){return this.each(function(){var n=e.data(this,"plugin_"+r);if(n){if(typeof t==="string"){n[t].apply(n)}else{n.updateOptions(t)}}else if(t!=="destroy"){e.data(this,"plugin_"+r,new o(this,t))}})}})(jQuery,window)
